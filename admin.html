<!doctype html><html lang="es"><head>
  <meta charset='utf-8'/>
  <meta name='viewport' content='width=device-width, initial-scale=1'/>
  <title>Autopartes Siordia — Admin</title>
  <script src='https://unpkg.com/react@18/umd/react.production.min.js' crossorigin></script>
  <script src='https://unpkg.com/react-dom@18/umd/react-dom.production.min.js' crossorigin></script>
  <script src='https://cdn.tailwindcss.com'></script>
  <style>
    body{background:#000;color:#fff}
    .card{border:1px solid #27272a;background:#0a0a0a;border-radius:16px;overflow:hidden}
    .gold{color:#facc15}
    .btn{border-radius:12px;padding:.5rem .75rem;border:1px solid #3f3f46}
    .btn-gold{background:#facc15;color:#000;border-color:#eab308}
  </style>
</head><body>
  <div id="root" class="min-h-screen"></div>
  <script>
    const {useEffect,useMemo,useState} = React;
    const mxn=(n)=> (n==null? "A convenir" : n.toLocaleString("es-MX",{style:"currency",currency:"MXN",maximumFractionDigits:0}));
    function App(){
      const [items,setItems]=useState(()=>{ try{return JSON.parse(localStorage.getItem("autos_catalog"))||[]}catch(e){return []} });
      const [q,setQ]=useState(""),[showAdd,setShowAdd]=useState(false),[showImport,setShowImport]=useState(false),[url,setUrl]=useState("./catalogo.json");
      useEffect(()=>{ try{localStorage.setItem("autos_catalog", JSON.stringify(items))}catch(e){} },[items]);
      const filtered=useMemo(()=> items.filter(p=>{
        if(!q.trim()) return true;
        const t=(p.title+" "+p.make+" "+p.model+" "+p.vehicle+" "+(p.oemCodes||[]).join(" ")).toLowerCase();
        return t.includes(q.toLowerCase());
      }), [items,q]);
      function loadFromURL(){
        fetch(url+"?ts="+Date.now()).then(r=>r.json()).then(arr=>{
          if(!Array.isArray(arr)) throw new Error("El JSON debe ser un array");
          setItems(arr); alert("Cargado desde URL. Edita y luego Exportar JSON para subirlo al repo.");
        }).catch(e=> alert("Error: "+e.message));
      }
      function exportJSON(){
        const blob=new Blob([JSON.stringify(items,null,2)],{type:"application/json"});
        const a=document.createElement("a"); a.href=URL.createObjectURL(blob); a.download="catalogo.json"; a.click();
      }
      function addItem(form){
        const id=form.id.value||((form.make.value||"ITEM").slice(0,4).toUpperCase()+"-"+Date.now());
        const oems=form.oem.value? form.oem.value.split(",").map(s=>s.trim()).filter(Boolean):[];
        const imgs=form.images.value? form.images.value.split(",").map(s=>s.trim()).filter(Boolean):[];
        const it={ id, title:form.title.value, make:form.make.value, model:form.model.value, year:Number(form.year.value||0), category:form.category.value, vehicle:form.vehicle.value, condition:form.condition.value, available:form.available.checked, price: form.price.value? Number(form.price.value): null, oemCodes:oems, description:form.description.value, images:imgs };
        setItems(prev=>[it,...prev]); setShowAdd(false); form.reset();
      }
      function remove(id){ if(confirm("¿Eliminar pieza?")) setItems(prev=> prev.filter(p=>p.id!==id)); }
      return React.createElement("div",{className:"max-w-7xl mx-auto px-4 py-6"},
        React.createElement("header",{className:"flex items-center justify-between py-4 border-b border-zinc-800 sticky top-0 bg-black/80 backdrop-blur z-10"},
          React.createElement("div",{className:"flex items-center gap-3"},
            React.createElement("div",{className:"w-9 h-9 rounded-xl",style:{background:"linear-gradient(135deg,#fde047,#f59e0b)"}}),
            React.createElement("div",null,
              React.createElement("h1",{className:"text-xl font-semibold gold"},"Autopartes Siordia — Admin"),
              React.createElement("p",{className:"text-xs text-zinc-400 -mt-0.5"},"Edita/Importa y luego Exportar JSON → súbelo al repo como catalogo.json")
            )
          ),
          React.createElement("div",{className:"flex items-center gap-2"},
            React.createElement("input",{value:q,onChange:e=>setQ(e.target.value),placeholder:"Buscar...",className:"rounded-xl bg-zinc-900 border border-zinc-800 px-3 py-2"}),
            React.createElement("button",{onClick:()=>setShowAdd(true),className:"btn"},"+ Añadir pieza"),
            React.createElement("button",{onClick:()=>setShowImport(true),className:"btn"},"Importar JSON"),
            React.createElement("button",{onClick:exportJSON,className:"btn btn-gold"},"Exportar JSON")
          )
        ),
        React.createElement("section",{className:"flex items-center gap-2 py-3"},
          React.createElement("input",{value:url,onChange:e=>setUrl(e.target.value),className:"grow rounded-xl bg-zinc-900 border border-zinc-800 px-3 py-2"}),
          React.createElement("button",{onClick:loadFromURL,className:"btn"},"Cargar desde URL")
        ),
        filtered.length===0
          ? React.createElement("p",{className:"text-zinc-400"},"No hay piezas. Usa + Añadir o Importar JSON.")
          : React.createElement("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-6"},
              filtered.map(p=>React.createElement("article",{key:p.id,className:"card"},
                React.createElement("div",{className:"aspect-[16/10] bg-zinc-900 grid place-items-center text-zinc-600 text-sm"},
                  (p.images&&p.images[0])? React.createElement("img",{src:p.images[0],alt:p.title,className:"w-full h-full object-cover"}):"Sin foto"
                ),
                React.createElement("div",{className:"p-4 space-y-2"},
                  React.createElement("input",{defaultValue:p.title,onChange:e=>p.title=e.target.value,className:"w-full bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
                  React.createElement("div",{className:"grid grid-cols-3 gap-2"},
                    React.createElement("input",{defaultValue:p.make,onChange:e=>p.make=e.target.value,placeholder:"Marca",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
                    React.createElement("input",{defaultValue:p.model,onChange:e=>p.model=e.target.value,placeholder:"Modelo",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
                    React.createElement("input",{defaultValue:p.year,onChange:e=>p.year=Number(e.target.value||0),placeholder:"Año",type:"number",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"})
                  ),
                  React.createElement("div",{className:"grid grid-cols-2 gap-2"},
                    React.createElement("input",{defaultValue:p.category,onChange:e=>p.category=e.target.value,placeholder:"Categoría",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
                    React.createElement("input",{defaultValue:p.vehicle,onChange:e=>p.vehicle=e.target.value,placeholder:"Vehículo",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"})
                  ),
                  React.createElement("div",{className:"grid grid-cols-2 gap-2"},
                    React.createElement("select",{defaultValue:p.condition,onChange:e=>p.condition=e.target.value,className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"},
                      React.createElement("option",{value:"usado"},"usado"),
                      React.createElement("option",{value:"nuevo"},"nuevo")
                    ),
                    React.createElement("input",{defaultValue:p.price,onChange:e=>p.price=Number(e.target.value||0),placeholder:"Precio",type:"number",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"})
                  ),
                  React.createElement("label",{className:"flex items-center gap-2 text-sm text-zinc-300"},
                    React.createElement("input",{type:"checkbox",defaultChecked:p.available,onChange:e=>p.available=e.target.checked}),"Disponible"
                  ),
                  React.createElement("input",{defaultValue:(p.oemCodes||[]).join(", "),onChange:e=>p.oemCodes=e.target.value.split(",").map(s=>s.trim()).filter(Boolean),placeholder:"OEM separados por coma",className:"w-full bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
                  React.createElement("input",{defaultValue:(p.images||[]).join(", "),onChange:e=>p.images=e.target.value.split(",").map(s=>s.trim()).filter(Boolean),placeholder:"URLs de imágenes separadas por coma",className:"w-full bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
                  React.createElement("textarea",{defaultValue:p.description,onChange:e=>p.description=e.target.value,placeholder:"Descripción",className:"w-full bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2 min-h-[80px]"}),
                  React.createElement("div",{className:"flex items-center justify-between pt-2"},
                    React.createElement("span",{className:"text-xs text-zinc-500"},"ID: "+p.id),
                    React.createElement("button",{onClick:()=>remove(p.id),className:"btn"},"Eliminar")
                  )
                )
              ))
            ),
        showAdd && React.createElement("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm grid place-items-center p-4", onClick:()=>setShowAdd(false)},
          React.createElement("div",{className:"max-w-3xl w-full card", onClick:e=>e.stopPropagation()},
            React.createElement("div",{className:"flex items-center justify-between p-4 border-b border-zinc-800"},
              React.createElement("h4",{className:"gold text-lg"},"Añadir pieza"),
              React.createElement("button",{className:"btn",onClick:()=>setShowAdd(false)},"✕")
            ),
            React.createElement("form",{className:"grid md:grid-cols-2 gap-3 p-4", onSubmit:(e)=>{e.preventDefault(); addItem(e.currentTarget);}},
              React.createElement("input",{name:"id",placeholder:"ID (opcional)",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("input",{name:"title",required:true,placeholder:"Título",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("input",{name:"make",required:true,placeholder:"Marca",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("input",{name:"model",required:true,placeholder:"Modelo",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("input",{name:"year",required:true,type:"number",placeholder:"Año",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("input",{name:"category",required:true,placeholder:"Categoría",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("input",{name:"vehicle",placeholder:"Vehículo",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("select",{name:"condition",defaultValue:"usado",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"},
                React.createElement("option",{value:"usado"},"usado"),
                React.createElement("option",{value:"nuevo"},"nuevo")
              ),
              React.createElement("input",{name:"price",type:"number",placeholder:"Precio",className:"bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("label",{className:"flex items-center gap-2 text-sm text-zinc-300"},
                React.createElement("input",{name:"available",type:"checkbox",defaultChecked:true}),"Disponible"
              ),
              React.createElement("input",{name:"oem",placeholder:"OEM (separados por coma)",className:"md:col-span-2 bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("input",{name:"images",placeholder:"URLs de imágenes (separadas por coma)",className:"md:col-span-2 bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2"}),
              React.createElement("textarea",{name:"description",placeholder:"Descripción",className:"md:col-span-2 bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2 min-h-[80px]"}),
              React.createElement("div",{className:"md:col-span-2 flex items-center justify-end gap-2"},
                React.createElement("button",{type:"button",className:"btn",onClick:()=>setShowAdd(false)},"Cancelar"),
                React.createElement("button",{type:"submit",className:"btn btn-gold"},"Guardar")
              )
            )
          )
        ),
        showImport && React.createElement("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm grid place-items-center p-4", onClick:()=>setShowImport(false)},
          React.createElement("div",{className:"max-w-3xl w-full card", onClick:e=>e.stopPropagation()},
            React.createElement("div",{className:"flex items-center justify-between p-4 border-b border-zinc-800"},
              React.createElement("h4",{className:"gold text-lg"},"Importar desde JSON"),
              React.createElement("button",{className:"btn",onClick:()=>setShowImport(false)},"✕")
            ),
            React.createElement("div",{className:"p-4 space-y-3"},
              React.createElement("p",{className:"text-sm text-zinc-300"},"Pega un array JSON con productos. Si hay IDs repetidos, se actualizarán."),
              React.createElement("textarea",{id:"jsonTextarea",className:"w-full min-h-[220px] bg-zinc-900 border border-zinc-800 rounded-xl px-3 py-2 text-sm",placeholder:'[{"id":"CLIO-MANIJA-INT-IZQ-2005","title":"Manija interior puerta izquierda — Clio 2005","make":"Renault","model":"Clio","year":2005,"category":"Interior","vehicle":"Clio K4M","condition":"usado","available":true,"price":150,"oemCodes":["7700-xxx"],"description":"En buen estado.","images":["https://.../foto.jpg"]}]'}),
              React.createElement("div",{className:"flex items-center justify-end gap-2"},
                React.createElement("button",{className:"btn btn-gold",onClick:()=>{ try{ const arr=JSON.parse(document.getElementById("jsonTextarea").value); if(!Array.isArray(arr)) throw new Error("El JSON debe ser un array"); const map=Object.fromEntries(items.map(p=>[p.id,p])); arr.forEach(p=>{ if(p&&p.id) map[p.id]=Object.assign(map[p.id]||{},p); }); setItems(Object.values(map)); setShowImport(false); }catch(e){ alert("Error: "+e.message); } }},"Importar")
              )
            )
          )
        )
      );
    }
    ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App));
  </script>
</body></html>
